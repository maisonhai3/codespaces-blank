# Fluent Bit configuration optimized for 10K logs/sec
[SERVICE]
    Flush         0.1
    Log_Level     error
    Daemon        off
    Parsers_File  parsers.conf
    HTTP_Server   Off
    storage.path  /tmp/flb-storage/
    storage.sync  full
    storage.checksum  off
    storage.backlog.mem_limit  128M
    storage.max_chunks_pause  off

[INPUT]
    Name              tail
    Path              /shared-logs/aiscout.log
    Tag               aiscout.logs
    Parser            json
    Refresh_Interval  0.1
    Read_from_Head    true
    # High-throughput optimizations
    Buffer_Chunk_Size 1M
    Buffer_Max_Size   16M
    Skip_Long_Lines   On
    Skip_Empty_Lines  On
    storage.type      filesystem
    Mem_Buf_Limit     64M
    
[FILTER]
    Name    modify
    Match   *
    Add     logtype aiscout

[OUTPUT]
    Name  es
    Match *
    Host  elasticsearch
    Port  9200
    Index fluent-bit-logs
    # High-throughput bulk optimization
    Buffer_Size         1M
    # HTTP optimization for 10K logs/sec
    Workers             8
    Retry_Limit         3
    Suppress_Type_Name  On
    # Disable compression for maximum speed
    Compress            Off
    # Connection settings
    tls                 Off
    HTTP_User           elastic
    HTTP_Passwd         changeme
    # Connection pooling
    net.keepalive       on
    net.keepalive_idle_timeout  30s
    # Bulk settings
    total_limit_size    128M
